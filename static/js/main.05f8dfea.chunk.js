(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){e.exports=a.p+"static/media/logomark.fa69dc67.svg"},132:function(e,t,a){e.exports=a(346)},137:function(e,t,a){},346:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(19),l=a.n(o),i=(a(137),a(76)),s=a(16),c=a.n(s),p=a(26),x=a(14),d=a(119),u=a(120),m=a(130),h=a(121),g=a(131),f=a(21),b=(a(78),a(122)),v=a.n(b),y=a(49),w=a.n(y),k=a(71),E=a.n(k);var C=function(e){var t=e.trades,a=e.onChangeFilter;return r.a.createElement("div",{className:"h-full border border-mm-gray-600 overflow-x-auto overflow-y-hidden rounded-lg scrollbar text-white"},r.a.createElement("table",{className:"w-full text-center"},r.a.createElement("caption",{className:"text-left"},r.a.createElement("label",{className:"inline-flex items-center justify-center p-[11px] 3xl:p-[16px] 8xl:p-[24px] focus-within:text-white font-semibold text-mm-gray-400"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-[13px] h-[13px] 3xl:w-[20px] 3xl:h-[20px] 8xl:w-[30px] 8xl:h-[30px]",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})),r.a.createElement("input",{className:"w-full bg-transparent focus:outline-none leading-[16px] 3xl:leading-[24px] 8xl:leading-[36px] pl-[7px] 3xl:pl-[10px] 8xl:pl-[15px] text-[11px] 3xl:text-[16px] 8xl:text-[24px]",type:"text",placeholder:"Add a filter",onChange:a}))),r.a.createElement("thead",{className:"sticky top-0"},r.a.createElement("tr",{className:"bg-mm-gray-800 leading-[21px] 3xl:leading-[32px] 8xl:leading-[48px] text-[12px] 3xl:text-[18px] 8xl:text-[27px]"},["type","symbol","price","location","region","strategy","timestamp"].map(function(e){return r.a.createElement("th",{className:"py-[8px] 3xl:py-[12px] 8xl:py-[18px] uppercase",key:e},e)}))),r.a.createElement("tbody",null,t.map(function(e){return r.a.createElement("tr",{key:"".concat(e.timestamp,"-").concat(e.trade_price),className:"bg-mm-gray-800/60 border-y border-mm-gray-600 leading-[21px] 3xl:leading-[32px] 8xl:leading-[48px] text-[12px] 3xl:text-[18px] 8xl:text-[27px]",style:{color:"SELL"===e.trade_type?"#F6E05E":"#68D391"}},r.a.createElement("td",{className:"font-extrabold py-[11px] 3xl:py-[16px] 8xl:py-[24px]"},e.trade_type),r.a.createElement("td",{className:"font-medium py-[11px] 3xl:py-[16px] 8xl:py-[24px]"},e.symbol),r.a.createElement("td",{className:"font-semibold font-source-code-pro py-[11px] 3xl:py-[16px] 8xl:py-[24px] text-[14px] 3xl:text-[21px] 8xl:text-[32px]"},e.trade_price),r.a.createElement("td",{className:"font-medium py-[11px] 3xl:py-[16px] 8xl:py-[24px]"},e.trade_location),r.a.createElement("td",{className:"font-medium py-[11px] 3xl:py-[16px] 8xl:py-[24px]"},e.quote_region),r.a.createElement("td",{className:"font-medium py-[11px] 3xl:py-[16px] 8xl:py-[24px]"},e.trade_strategy),r.a.createElement("td",{className:"font-semibold font-source-code-pro py-[11px] 3xl:py-[16px] text-[14px] 3xl:text-[21px] 8xl:text-[32px]"},e.timestamp))}))))},S=a(123),O=a.n(S),j=a(124),N=a(51),D=a.n(N),R=0,U=1,M=2,T="#3B9DE6",W="#262626";D()("USD"),D()("EUR"),D()("JPY");function B(){return Math.floor(Math.random()*Math.floor(99999))}var L=function(e){return"CryptoTraderQuotesAvg".concat(e,"New")},F=function(e){var t="string"===typeof e?parseFloat(e):e,a=new Date(1e3*t).toUTCString(),n=a.indexOf("GMT");return a.substring(0,n).trim()},_=function(e,t){var a=e.close,n=e.ma,r=e.timestamp,o=w.a.cloneDeep(t);o.close.push(a),o.ma.push(n);var l=F(r),i=l.lastIndexOf(" ");return o.timestamp.push(l.substr(i).trim()),o},I=function(e){var t="string"===typeof e?e:e.toString();return t.includes(".")?t:"".concat(t,".00")},z=function(e){var t,a,n,r,o=Object(j.a)({},e),l=o.symbol;return l?(t=l.includes("JPY")?"Tokyo":l.includes("USD")?"NYC":"Frankfurt",o.trade_location=t,o.trade_price=I(o.trade_price),o.timestamp=(a=o.timestamp,n=F(a),r=n.lastIndexOf(" "),n.substr(r).trim())):o=void 0,o},P=a(129),J=a.n(P),A=a(36),H=a.n(A),Y=a(70),V=a(50),q=a.n(V),G=a(72),$=a.n(G),Q=a(75),K=a.n(Q),X=a(74),Z=a.n(X),ee=a(73),te=a.n(ee),ae=a(128),ne=a.n(ae),re=a(126),oe=a.n(re),le=a(127),ie=a.n(le),se=R,ce=U,pe=M,xe=W,de=function(e){function t(e){var a,n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state=(a={width:0,height:0},Object(x.a)(a,se,{name:"USD",close:[],ma:[],timestamp:[],stream:void 0}),Object(x.a)(a,ce,{name:"EUR",close:[],ma:[],timestamp:[],stream:void 0}),Object(x.a)(a,pe,{name:"JPY",close:[],ma:[],timestamp:[],stream:void 0}),Object(x.a)(a,"collectionData",[]),Object(x.a)(a,"filteredData",[]),Object(x.a)(a,"showSnackbar",!1),Object(x.a)(a,"snackbarText",""),Object(x.a)(a,"showFiltered",!1),Object(x.a)(a,"regionModal",!1),Object(x.a)(a,"availableRegions",null),Object(x.a)(a,"selectedRegionUrl",null),Object(x.a)(a,"loginModal",!0),Object(x.a)(a,"federationUrl","gdndemo.paas.macrometa.io"),Object(x.a)(a,"fabric","crypto_trading_bot"),Object(x.a)(a,"email","demo@macrometa.io"),Object(x.a)(a,"password","demo"),Object(x.a)(a,"selectedRegionName",null),a),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(f.a)(Object(f.a)(n))),n.establishConnection=n.establishConnection.bind(Object(f.a)(Object(f.a)(n))),n.handleClose=n.handleClose.bind(Object(f.a)(Object(f.a)(n))),n.openSnackBar=n.openSnackBar.bind(Object(f.a)(Object(f.a)(n))),n.handleSearchTextChange=n.handleSearchTextChange.bind(Object(f.a)(Object(f.a)(n))),n.jwtToken=void 0,n.fabric=void 0,n.collection=void 0,n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("resize",this.updateWindowDimensions),[se,ce,pe].forEach(function(t){e.state[t].stream.closeConnections()}),this.collection.closeOnChangeConnection()}},{key:"initData",value:function(){var e=Object(p.a)(c.a.mark(function e(){var t,a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[se,ce,pe],n=0;case 2:if(!(n<a.length)){e.next=9;break}return e.next=5,this.establishConnection(n);case 5:a[n]=e.sent;case 6:n++,e.next=2;break;case 9:this.setState((t={},Object(x.a)(t,se,a[se]),Object(x.a)(t,ce,a[ce]),Object(x.a)(t,pe,a[pe]),t)),this.getDocumentData(),this.establishDocumentConnection();case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"selectedRegionLogin",value:function(){var e=Object(p.a)(c.a.mark(function e(){var t,a,n,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.fabric.close(),t=this.state,a=t.selectedRegionUrl,n=t.email,r=t.password,o=this.state.fabric,this.fabric=new E.a("https://".concat(a)),e.prev=4,e.next=7,this.fabric.login(n,r);case 7:return this.fabric.useFabric(o),e.next=10,this.initData();case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),this.openSnackBar("Failed to login with selected region."),console.log(e.t0);case 16:case"end":return e.stop()}},e,this,[[4,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(p.a)(c.a.mark(function e(){var t,a,n,r,o,l,i,s,p,x,d,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.federationUrl,n=t.email,r=t.password,o=this.state.fabric,this.fabric=new E.a("https://".concat(a)),e.prev=3,e.next=6,this.fabric.login(n,r);case 6:return l=e.sent,this.fabric.useFabric(o),e.next=10,this.fabric.get();case 10:return i=e.sent,s=i.options.dcList.split(","),p=this.fabric.tenant("",l.tenant),e.next=15,p.getTenantEdgeLocations();case 15:x=e.sent,d=x[0].dcInfo,u=d.filter(function(e){return s.indexOf(e.name>-1)}),this.setState({availableRegions:u,regionModal:!0}),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),this.openSnackBar("Auth failed."),console.log(e.t0);case 25:case"end":return e.stop()}},e,this,[[3,21]])}));return function(){return e.apply(this,arguments)}}()},{key:"getDocumentData",value:function(){var e=Object(p.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fabric.query("FOR trade IN trades SORT trade.timestamp DESC LIMIT 20 RETURN trade");case 3:return t=e.sent,e.next=6,t.all();case 6:a=e.sent,this.setState({collectionData:(n=a,n.map(z))}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),404!==e.t0.status&&this.openSnackBar("Could not get document data");case 13:case"end":return e.stop()}var n},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"establishDocumentConnection",value:function(){var e=Object(p.a)(c.a.mark(function e(){var t,a=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"trades",this.collection=this.fabric.collection("trades"),e.next=4,this.collection.onChange(this.state.selectedRegionUrl,"".concat("trades","-sub").concat(B()));case 4:(t=e.sent).on("error",function(){a.openSnackBar("Failed to establish WS connection for trades"),console.log("Failed to establish WS connection for trades")}),t.on("message",function(e){var t=JSON.parse(e),n=t.payload;if(t&&n){var r=atob(n),o=r&&JSON.parse(r),l=Object(i.a)(a.state.collectionData),s=z(o);s&&(l=[s].concat(Object(i.a)(l))),l.length>20&&(l=l.slice(0,20)),a.setState({collectionData:l})}}),t.on("close",function(){console.log("Closing WS connection for trades")}),t.on("open",function(){console.log("WebSocket is open for trades")});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"establishConnection",value:function(){var e=Object(p.a)(c.a.mark(function e(t){var a,n,r,o,l,i,s=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=w.a.cloneDeep(this.state[t]),n=this.state[t].name,r=L(n),o=this.fabric.stream(r,!1),e.next=6,o.getOtp();case 6:return l=e.sent,(i=o.consumer("".concat(n,"-sub").concat(B()),this.state.selectedRegionUrl,{otp:l})).on("error",function(){s.openSnackBar("Failed to establish WS connection"),console.log("Failed to establish WS connection for ".concat(r))}),i.on("message",function(e){var a=JSON.parse(e),n=a.payload;if(a&&n){var r=atob(n),o=r&&JSON.parse(r);console.log("CHART CONSUMER MSG:",o),s.setState(Object(x.a)({},t,_(o,s.state[t])))}}),i.on("close",function(){console.log("Closing WS connection for ".concat(r))}),i.on("open",function(){console.log("Connection open for ".concat(r))}),a.stream=o,e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"handleClose",value:function(){this.setState({showSnackbar:!1,snackbarText:""})}},{key:"openSnackBar",value:function(e){var t=this;this.setState({showSnackbar:!0,snackbarText:e},function(){setTimeout(t.handleClose,2e3)})}},{key:"handleSearchTextChange",value:function(e){var t=e.target.value;this.filterResults(t)}},{key:"filterResults",value:function(e){var t=this;this.setState({showFiltered:!!e.trim()},function(){var a=t.state.collectionData.filter(function(t){var a=e.toUpperCase();return t.symbol.toUpperCase().includes(a)||t.trade_price.toUpperCase().includes(a)||t.trade_location.toUpperCase().includes(a)||t.quote_region.toUpperCase().includes(a)||t.timestamp.toUpperCase().includes(a)||t.trade_strategy.toUpperCase().includes(a)||t.trade_type.toUpperCase().includes(a)});t.setState({filteredData:a})})}},{key:"renderCharts",value:function(e){var t,a,n,o=this.state[e],l=o.timestamp,i=o.ma,s=o.close,c=s[s.length-1]||0,p=I(c);switch(e){case se:t="BTC-USD",a="Coinbase Pro",n="$".concat(p);break;case ce:t="BTC-EUR",a="BitStamp",n="\u20ac".concat(p);break;default:t="BTC-JPY",a="Bitflyer",n="\xa5".concat(p)}var x,d={margin:this.state.width>=1920?{t:10}:{t:5,b:5,l:40,r:5,pad:0},font:{size:this.state.width>=1920?12:6},showlegend:!1,title:void 0,paper_bgcolor:"transparent",plot_bgcolor:"transparent",xaxis:{showticklabels:this.state.width>=1920,tickfont:{color:"white"},showgrid:!0,gridcolor:"#535968",fixedrange:!1,zerolinecolor:"#535968"},yaxis:{tickfont:{color:"white"},showgrid:!0,gridcolor:"#535968",fixedrange:!1,zerolinecolor:"#535968"}},u=[{x:x=l,y:i,type:"line",marker:{color:T},name:"ma"},{x:x,y:s,type:"line",marker:{color:"orange"},name:"price"}];return r.a.createElement("div",{key:e,className:"h-full flex flex-col text-white pb-[13px] 3xl:pb-[20px] 8xl:pb-[30px]"},r.a.createElement("div",{className:"grow bg-mm-gray-800 border border-mm-gray-600 font-extrabold leading-[21px] 3xl:leading-[32px] 8xl:leading-[48px] pl-[11px] 3xl:pl-[16px] 8xl:pl-[24px] pt-[8px] 3xl:pt-[12px] 8xl:pt-[18px] rounded-t-lg text-[14px] 3xl:text-[21px] 8xl:text-[32px]"},t,r.a.createElement("span",{className:"font-medium leading-[21px] 3xl:leading-[32px] 8xl:leading-[48px] text-[12px] 3xl:text-[18px] 8xl:text-[27px]"},"\xa0",a),r.a.createElement("div",{className:"mt-[8px] w-[380px] h-[180px] 3xl:mt-[12px] 3xl:w-[500px] 3xl:h-[260px] 4xl:mt-[16px] 4xl:w-[700px] 4xl:h-[460px] 8xl:mt-[24px] 8xl:w-[1000px] 8xl:h-[700px]"},r.a.createElement(v.a,{key:e.toString(),data:u,layout:d,useResizeHandler:!0,style:{width:"100%",height:"100%"},config:{displayModeBar:!1}}))),r.a.createElement("div",{className:"bg-mm-gray-800/60 border border-mm-gray-600 font-semibold font-source-code-pro py-[21px] 3xl:py-[32px] 8xl:py-[48px] rounded-b-lg text-[32px] 3xl:text-[48px] 8xl:text-[72px] text-center"},n))}},{key:"renderRegionModal",value:function(){var e=this,t=this.state,a=t.regionModal,n=t.availableRegions,o=t.selectedRegionUrl;return r.a.createElement($.a,{fullWidth:!0,open:a},r.a.createElement(te.a,{id:"form-dialog-title"},"Select Region:"),r.a.createElement(Z.a,null,r.a.createElement(oe.a,{onChange:function(t){var a=t.target,n=a.value,r=a.labels;e.setState({selectedRegionUrl:n,selectedRegionName:r[0].outerText})},value:o},n.map(function(e){var t=e.locationInfo,a=t.city,n=t.countrycode,o=e.tags.url;"SG"===n&&(a="Singapore");var l="".concat(a,", ").concat(n);return r.a.createElement(ie.a,{key:l,value:o,control:r.a.createElement(ne.a,null),label:l})}))),r.a.createElement(K.a,null,r.a.createElement(q.a,{disabled:!o,onClick:function(){return e.setState({regionModal:!1},function(){e.selectedRegionLogin()})},size:"small",variant:"text",color:"primary"},r.a.createElement("span",{className:"actions"},"CONFIRM"))))}},{key:"renderLoginModal",value:function(){var e=this,t=this.state.loginModal,a=this.props.classes;return r.a.createElement($.a,{fullWidth:!0,open:t},r.a.createElement(te.a,{id:"form-dialog-title"}," Please login with defaults or use your own account:"),r.a.createElement(Z.a,{style:{display:"flex",flexDirection:"column",maxWidth:"300px"}},r.a.createElement(H.a,{InputProps:{className:a.input},label:"Federation URL",defaultValue:this.state.federationUrl,onChange:function(t){var a=t.target.value;e.setState({federationUrl:a})},margin:"normal"}),r.a.createElement(H.a,{InputProps:{className:a.input},label:"Email",defaultValue:this.state.email,onChange:function(t){var a=t.target.value;e.setState({email:a})},margin:"normal"}),r.a.createElement(H.a,{InputProps:{className:a.input},label:"Fabric",defaultValue:this.state.fabric,onChange:function(t){var a=t.target.value;e.setState({fabric:a})},margin:"normal"}),r.a.createElement(H.a,{type:"password",id:"pass",label:"Password",defaultValue:this.state.password,InputProps:{className:a.input},onChange:function(t){var a=t.target.value;e.setState({password:a})},margin:"normal"})),r.a.createElement(K.a,null,r.a.createElement(q.a,{onClick:function(){return e.setState({loginModal:!1},function(){e.login()})},size:"small",variant:"text",color:"primary"},r.a.createElement("span",{className:"actions"},"CONFIRM"))))}},{key:"render",value:function(){var e=this,t=this.state,a=t.showFiltered,n=t.collectionData,o=t.filteredData,l=t.showSnackbar,i=t.snackbarText,s=(this.props.classes,a?o:n);return r.a.createElement("div",null,r.a.createElement("div",{className:"bg-mm-gray-900 grid px-[12px] 3xl:px-0 3xl:grid-cols-12"},r.a.createElement("div",{className:"3xl:col-start-2 3xl:col-end-12"},r.a.createElement("div",{className:"lg:h-screen"},r.a.createElement("div",{className:"bg-transparent flex flex-row justify-between items-center h-[40px] 3xl:h-[64px] 8xl:h-[96px] text-white"},r.a.createElement("img",{className:"w-[100px] h-[27px] 3xl:w-[150px] 3xl:h-[40px] 8xl:w-[225px] 8xl:h-[60px]",src:O.a,alt:"Macrometa Logo"}),r.a.createElement("button",{className:"border border-mm-gray-600 font-medium inline-flex items-center justify-center leading-[16px] 3xl:leading-[24px] 8xl:leading-[36px] my-[8px] 3xl:my-[12px] 8xl:my-[18px] rounded-lg text-[11px] 3xl:text-[16px] 8xl:text-[24px] w-[100px] 3xl:w-[150px] 8xl:w-[225px] h-[27px] 3xl:h-[40px] 8xl:h-[60px] text-center"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-[13px] h-[13px] 3xl:w-[20px] 3xl:h-[20px] 8xl:w-[30px] 8xl:h-[30px] text-mm-gray-400",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor"},r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),r.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})),r.a.createElement("span",null,"\xa0",this.state.selectedRegionName||"Region"))),r.a.createElement("div",{className:"grid lg:grid-rows-2 h-[calc(100vh-40px)] 3xl:h-[calc(100vh-64px)] 8xl:h-[calc(100vh-96px)] "},r.a.createElement("div",{className:"grid lg:grid-cols-3 gap-4"},[se,ce,pe].map(function(t){return e.renderCharts(t)})),r.a.createElement(C,{trades:s,onChangeFilter:this.handleSearchTextChange}))))),r.a.createElement(J.a,{open:l,onClose:this.handleClose,message:r.a.createElement("span",{id:"message-id"},i)}),this.renderLoginModal(),this.state.regionModal&&this.renderRegionModal())}}]),t}(n.Component),ue=Object(Y.withStyles)(function(e){return{root:{backgroundColor:"#404040",marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:"100%"},tableHead:{backgroundColor:xe,color:"white"},tableBody:{backgroundColor:xe},headCell:{color:"white",fontSize:"0.75em",textAlign:"center",borderBottom:"none"},tableCell:{fontWeight:700,textAlign:"center",borderBottom:"none",fontSize:"16px"},input:{backgroundColor:"#404040",paddingLeft:"5px"}}})(de);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},78:function(e,t,a){}},[[132,2,1]]]);
//# sourceMappingURL=main.05f8dfea.chunk.js.map