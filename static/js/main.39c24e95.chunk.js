(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{126:function(e,t,a){e.exports=a.p+"static/media/logo.596666c9.svg"},139:function(e,t,a){e.exports=a(359)},144:function(e,t,a){},359:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(21),c=a.n(r),s=(a(144),a(79)),i=a(16),l=a.n(i),u=a(27),d=a(14),m=a(123),h=a(124),p=a(137),f=a(125),b=a(138),g=a(22),v=a(126),C=a.n(v),y=(a(81),a(127)),w=a.n(y),k=a(51),E=a.n(k),S=a(73),x=a.n(S),O=a(128),N=a(53),j=a.n(N),R=0,D=1,T=2,U="#3B9DE6",M="#A7CC55",_="#262626",B={CHART1_SIGN:j()("USD"),CHART2_SIGN:j()("EUR"),CHART3_SIGN:j()("JPY")};function W(){return Math.floor(Math.random()*Math.floor(99999))}var I=function(e){return"CryptoTraderQuotesAvg".concat(e,"New")},F=function(e){var t="string"===typeof e?parseFloat(e):e,a=new Date(1e3*t).toUTCString(),n=a.indexOf("GMT");return a.substring(0,n).trim()},A=function(e,t){var a=e.close,n=e.ma,o=e.timestamp,r=E.a.cloneDeep(t);r.close.push(a),r.ma.push(n);var c=F(o),s=c.lastIndexOf(" ");return r.timestamp.push(c.substr(s).trim()),r},L=function(e,t,a){return[{x:e,y:t,type:"line",marker:{color:U},name:"ma"},{x:e,y:a,type:"line",marker:{color:"orange"},name:"price"}]},P=function(e){var t="string"===typeof e?e:e.toString();return t.includes(".")?t:"".concat(t,".00")},H=function(e){var t,a,n,o,r=Object(O.a)({},e),c=r.symbol;return c?(t=c.includes("JPY")?"Tokyo":c.includes("USD")?"NYC":"Frankfurt",r.trade_location=t,r.trade_price=P(r.trade_price),r.timestamp=(a=r.timestamp,n=F(a),o=n.lastIndexOf(" "),n.substr(o).trim())):r=void 0,r},z=a(133),J=a.n(z),G=a(135),V=a.n(G),Y=a(19),q=a.n(Y),Q=a(134),$=a.n(Q),K=a(78),X=a.n(K),Z=a(136),ee=a.n(Z),te=a(33),ae=a.n(te),ne=a(72),oe=a(52),re=a.n(oe),ce=a(74),se=a.n(ce),ie=a(77),le=a.n(ie),ue=a(76),de=a.n(ue),me=a(75),he=a.n(me),pe=a(132),fe=a.n(pe),be=a(130),ge=a.n(be),ve=a(131),Ce=a.n(ve),ye=R,we=D,ke=T,Ee=U,Se=M,xe=_,Oe=function(e){function t(e){var a,n;return Object(m.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state=(a={width:0,height:0},Object(d.a)(a,ye,{name:"USD",close:[],ma:[],timestamp:[],stream:void 0}),Object(d.a)(a,we,{name:"EUR",close:[],ma:[],timestamp:[],stream:void 0}),Object(d.a)(a,ke,{name:"JPY",close:[],ma:[],timestamp:[],stream:void 0}),Object(d.a)(a,"collectionData",[]),Object(d.a)(a,"filteredData",[]),Object(d.a)(a,"showSnackbar",!1),Object(d.a)(a,"snackbarText",""),Object(d.a)(a,"showFiltered",!1),Object(d.a)(a,"regionModal",!1),Object(d.a)(a,"availableRegions",null),Object(d.a)(a,"selectedRegionUrl",null),Object(d.a)(a,"loginModal",!0),Object(d.a)(a,"federationUrl","gdn.5g.macrometa.io"),Object(d.a)(a,"fabric","_system"),Object(d.a)(a,"email","demo@macrometa.io"),Object(d.a)(a,"password","Demo@macrometa.io"),Object(d.a)(a,"selectedRegionName",null),a),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(g.a)(Object(g.a)(n))),n.establishConnection=n.establishConnection.bind(Object(g.a)(Object(g.a)(n))),n.handleClose=n.handleClose.bind(Object(g.a)(Object(g.a)(n))),n.openSnackBar=n.openSnackBar.bind(Object(g.a)(Object(g.a)(n))),n.handleSearchTextChange=n.handleSearchTextChange.bind(Object(g.a)(Object(g.a)(n))),n.jwtToken=void 0,n.fabric=void 0,n.collection=void 0,n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("resize",this.updateWindowDimensions),[ye,we,ke].forEach(function(t){e.state[t].stream.closeConnections()}),this.collection.closeOnChangeConnection()}},{key:"initData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[ye,we,ke],n=0;case 2:if(!(n<a.length)){e.next=9;break}return e.next=5,this.establishConnection(n);case 5:a[n]=e.sent;case 6:n++,e.next=2;break;case 9:this.setState((t={},Object(d.a)(t,ye,a[ye]),Object(d.a)(t,we,a[we]),Object(d.a)(t,ke,a[ke]),t)),this.getDocumentData(),this.establishDocumentConnection();case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"selectedRegionLogin",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,o,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.fabric.close(),t=this.state,a=t.selectedRegionUrl,n=t.email,o=t.password,r=this.state.fabric,this.fabric=new x.a("https://".concat(a)),e.prev=4,e.next=7,this.fabric.login(n,o);case 7:return this.fabric.useFabric(r),e.next=10,this.initData();case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),this.openSnackBar("Failed to login with selected region."),console.log(e.t0);case 16:case"end":return e.stop()}},e,this,[[4,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,o,r,c,s,i,u,d,m,h;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.federationUrl,n=t.email,o=t.password,r=this.state.fabric,this.fabric=new x.a("https://".concat(a)),e.prev=3,e.next=6,this.fabric.login(n,o);case 6:return c=e.sent,this.fabric.useFabric(r),e.next=10,this.fabric.get();case 10:return s=e.sent,i=s.options.dcList.split(","),u=this.fabric.tenant("",c.tenant),e.next=15,u.getTenantEdgeLocations();case 15:d=e.sent,m=d[0].dcInfo,h=m.filter(function(e){return i.indexOf(e.name>-1)}),this.setState({availableRegions:h,regionModal:!0}),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),this.openSnackBar("Auth failed."),console.log(e.t0);case 25:case"end":return e.stop()}},e,this,[[3,21]])}));return function(){return e.apply(this,arguments)}}()},{key:"getDocumentData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fabric.query("FOR trade IN trades SORT trade.timestamp DESC LIMIT 20 RETURN trade");case 3:return t=e.sent,e.next=6,t.all();case 6:a=e.sent,this.setState({collectionData:(n=a,n.map(H))}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),404!==e.t0.status&&this.openSnackBar("Could not get document data");case 13:case"end":return e.stop()}var n},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"establishDocumentConnection",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"trades",this.collection=this.fabric.collection("trades"),e.next=4,this.collection.onChange(this.state.selectedRegionUrl,"".concat("trades","-sub").concat(W()));case 4:(t=e.sent).on("error",function(){a.openSnackBar("Failed to establish WS connection for trades"),console.log("Failed to establish WS connection for trades")}),t.on("message",function(e){var t=JSON.parse(e),n=t.payload;if(t&&n){var o=atob(n),r=o&&JSON.parse(o),c=Object(s.a)(a.state.collectionData),i=H(r);i&&(c=[i].concat(Object(s.a)(c))),c.length>20&&(c=c.slice(0,20)),a.setState({collectionData:c})}}),t.on("close",function(){console.log("Closing WS connection for trades")}),t.on("open",function(){console.log("WebSocket is open for trades")});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"establishConnection",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,o,r,c,s,i=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=E.a.cloneDeep(this.state[t]),n=this.state[t].name,o=I(n),r=this.fabric.stream(o,!1),e.next=6,r.getOtp();case 6:return c=e.sent,(s=r.consumer("".concat(n,"-sub").concat(W()),this.state.selectedRegionUrl,{otp:c})).on("error",function(){i.openSnackBar("Failed to establish WS connection"),console.log("Failed to establish WS connection for ".concat(o))}),s.on("message",function(e){var a=JSON.parse(e),n=a.payload;if(a&&n){var o=atob(n),r=o&&JSON.parse(o);console.log("CHART CONSUMER MSG:",r),i.setState(Object(d.a)({},t,A(r,i.state[t])))}}),s.on("close",function(){console.log("Closing WS connection for ".concat(o))}),s.on("open",function(){console.log("Connection open for ".concat(o))}),a.stream=r,e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"handleClose",value:function(){this.setState({showSnackbar:!1,snackbarText:""})}},{key:"openSnackBar",value:function(e){var t=this;this.setState({showSnackbar:!0,snackbarText:e},function(){setTimeout(t.handleClose,2e3)})}},{key:"handleSearchTextChange",value:function(e){var t=e.target.value;this.filterResults(t)}},{key:"filterResults",value:function(e){var t=this;this.setState({showFiltered:!!e.trim()},function(){var a=t.state.collectionData.filter(function(t){var a=e.toUpperCase();return t.symbol.toUpperCase().includes(a)||t.trade_price.toUpperCase().includes(a)||t.trade_location.toUpperCase().includes(a)||t.quote_region.toUpperCase().includes(a)||t.timestamp.toUpperCase().includes(a)||t.trade_strategy.toUpperCase().includes(a)||t.trade_type.toUpperCase().includes(a)});t.setState({filteredData:a})})}},{key:"renderCharts",value:function(e){var t,a=this.state.width,n=this.state[e],r=n.timestamp,c=n.ma,s=n.close,i={showlegend:!1,title:void 0,paper_bgcolor:xe,plot_bgcolor:xe,width:a/3,height:350,xaxis:{tickfont:{color:"white"},showgrid:!0,gridcolor:"#6b6a6a",fixedrange:!1,zerolinecolor:"#6b6a6a"},yaxis:{tickfont:{color:"white"},showgrid:!0,gridcolor:"#6b6a6a",fixedrange:!1,zerolinecolor:"#6b6a6a"}};switch(e){case ye:t=L(r,c,s),i.title='<b style="color:white">BTC-USD @ Coinbase Pro</b>';break;case we:t=L(r,c,s),i.title='<b style="color:white">BTC-EUR @ BitStamp</b>';break;default:t=L(r,c,s),i.title='<b style="color:white">BTC-JPY @ Bitflyer</b>'}return o.a.createElement(w.a,{key:e.toString(),data:t,layout:i,useResizeHandler:!0,style:{height:"350px"}})}},{key:"renderRegionModal",value:function(){var e=this,t=this.state,a=t.regionModal,n=t.availableRegions,r=t.selectedRegionUrl;return o.a.createElement(se.a,{fullWidth:!0,open:a},o.a.createElement(he.a,{id:"form-dialog-title"},"Select Region:"),o.a.createElement(de.a,null,o.a.createElement(ge.a,{onChange:function(t){var a=t.target,n=a.value,o=a.labels;e.setState({selectedRegionUrl:n,selectedRegionName:o[0].outerText})},value:r},n.map(function(e){var t=e.locationInfo,a=t.city,n=t.countrycode,r=e.tags.url,c="".concat(a,", ").concat(n);return o.a.createElement(Ce.a,{key:c,value:r,control:o.a.createElement(fe.a,null),label:c})}))),o.a.createElement(le.a,null,o.a.createElement(re.a,{disabled:!r,onClick:function(){return e.setState({regionModal:!1},function(){e.selectedRegionLogin()})},size:"small",variant:"text",color:"primary"},o.a.createElement("span",{className:"actions"},"CONFIRM"))))}},{key:"renderLoginModal",value:function(){var e=this,t=this.state.loginModal,a=this.props.classes;return o.a.createElement(se.a,{fullWidth:!0,open:t},o.a.createElement(he.a,{id:"form-dialog-title"}," Please login with defaults or use your own account:"),o.a.createElement(de.a,{style:{display:"flex",flexDirection:"column",maxWidth:"300px"}},o.a.createElement(ae.a,{InputProps:{className:a.input},label:"Federation URL",defaultValue:this.state.federationUrl,onChange:function(t){var a=t.target.value;e.setState({federationUrl:a})},margin:"normal"}),o.a.createElement(ae.a,{InputProps:{className:a.input},label:"Email",defaultValue:this.state.email,onChange:function(t){var a=t.target.value;e.setState({email:a})},margin:"normal"}),o.a.createElement(ae.a,{InputProps:{className:a.input},label:"Fabric",defaultValue:this.state.fabric,onChange:function(t){var a=t.target.value;e.setState({fabric:a})},margin:"normal"}),o.a.createElement(ae.a,{type:"password",id:"pass",label:"Password",defaultValue:this.state.password,InputProps:{className:a.input},onChange:function(t){var a=t.target.value;e.setState({password:a})},margin:"normal"})),o.a.createElement(le.a,null,o.a.createElement(re.a,{onClick:function(){return e.setState({loginModal:!1},function(){e.login()})},size:"small",variant:"text",color:"primary"},o.a.createElement("span",{className:"actions"},"CONFIRM"))))}},{key:"render",value:function(){var e=this,t=this.state,a=t.showFiltered,n=t.collectionData,r=t.filteredData,c=t.showSnackbar,s=t.snackbarText,i=this.props.classes,l=a?r:n;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"Region",style:{backgroundColor:"black",marginTop:"10px",display:"flex",justifyContent:"center"}},o.a.createElement("span",{style:{color:"grey",fontSize:"18px"}},"Selected Region :  ",this.state.selectedRegionName,"   ")),o.a.createElement("div",{className:"row",style:{backgroundColor:"black",marginTop:"10px"}},[ye,we,ke].map(function(t){return e.renderCharts(t)})),o.a.createElement("div",{className:"row",style:{justifyContent:" space-around",padding:"30px 0 30px 0 ",backgroundColor:"black"}},[ye,we,ke].map(function(t){var a=e.state[t].close;return function(e,t){var a,n=R,r=D,c=P(t);switch(e){case n:a="".concat(B.CHART1_SIGN).concat(c);break;case r:a="".concat(B.CHART2_SIGN).concat(c);break;default:a="".concat(B.CHART3_SIGN).concat(c)}return o.a.createElement("span",{key:e,style:{display:"flex",justifyContent:"space-around"}},o.a.createElement("span",{className:"currentValue"},"Current Value"),o.a.createElement("span",{className:"currentValueText"},a))}(t,a[a.length-1]||0)})),o.a.createElement("div",{className:"row",style:{flex:1}},o.a.createElement("div",{className:"leftPane"},o.a.createElement("img",{alt:"Macrometa",style:{height:"64px",marginTop:"15px"},src:C.a}),o.a.createElement("div",{className:"textField"},o.a.createElement(ae.a,{label:"Filter",placeholder:"Enter here",onChange:this.handleSearchTextChange,classes:{root:i.root},margin:"normal",variant:"outlined"}))),o.a.createElement("div",{className:"tableContainer"},o.a.createElement(J.a,null,o.a.createElement($.a,{className:i.tableHead},o.a.createElement(X.a,null,o.a.createElement(q.a,{component:"th",className:i.headCell},"Symbol"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Price"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Location"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Region"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Timestamp"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Strategy"),o.a.createElement(q.a,{component:"th",className:i.headCell},"Type"))),o.a.createElement(V.a,{className:i.tableBody},l.map(function(e){var t=e.trade_type.includes("BUY")?Ee:Se;return o.a.createElement(X.a,{key:Math.random()},o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.symbol),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.trade_price),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.trade_location),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.quote_region),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.timestamp),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.trade_strategy),o.a.createElement(q.a,{className:i.tableCell,style:{color:t}},e.trade_type))}))))),o.a.createElement(ee.a,{open:c,onClose:this.handleClose,message:o.a.createElement("span",{id:"message-id"},s)}),this.renderLoginModal(),this.state.regionModal&&this.renderRegionModal())}}]),t}(n.Component),Ne=Object(ne.withStyles)(function(e){return{root:{backgroundColor:"#404040",marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:"100%"},tableHead:{backgroundColor:xe,color:"white"},tableBody:{backgroundColor:xe},headCell:{color:"white",fontSize:"0.75em",textAlign:"center",borderBottom:"none"},tableCell:{fontWeight:700,textAlign:"center",borderBottom:"none",fontSize:"16px"},input:{backgroundColor:"#404040",paddingLeft:"5px"}}})(Oe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(Ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},81:function(e,t,a){}},[[139,2,1]]]);
//# sourceMappingURL=main.39c24e95.chunk.js.map